language: java

jdk:
 - oraclejdk7

before_install:
  - wget https://s3.amazonaws.com/travis-phantomjs/phantomjs-2.0.0-ubuntu-12.04.tar.bz2
  - tar -xjf phantomjs-2.0.0-ubuntu-12.04.tar.bz2
  - sudo rm -rf /usr/local/phantomjs/bin/phantomjs
  - sudo mv phantomjs /usr/local/phantomjs/bin/phantomjs
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - sleep 3 # give xvfb some time to start
  - "/sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -ac -screen 0 1280x1024x16"
  - sleep 5
  - export TZ=Europe/Kiev
  - date
  - pwd
  - "ls -lh"

script:
 - mvn clean test

after_script:
  - mvn -Dallure.issues.tracker.pattern=http://google.com/issues/%%s -Dallure.tests.management.pattern=http://google.com/tests/%%s -Dproject.build.sourceEncoding=UTF-8 -Dproject.reporting.outputEncoding=UTF-8 site
  - sleep 3
  - pwd
  - "ls -lh /home/travis/build/dstoianov/allure-testng-example/target/"
  - "ls -lh target/site/allure-maven-plugin/"
  - "tar -zcvf allure_result.tar.gz target/site/allure-maven-plugin/"
  - sleep 1
  - "ls -lh target/site/allure-maven-plugin/"
  - "ls -lh"
  - sleep 2

notifications:
 email: false